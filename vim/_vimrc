set nocompatible               " be iMproved

filetype off                   " required!

set runtimepath+=~/.vim/bundles/repos/github.com/Shougo/dein.vim

if dein#load_state('~/.vim/bundles')
  call dein#begin('~/.vim/bundles')

  " Let dein manage dein
  call dein#add('~/.vim/bundles/repos/github.com/Shougo/dein.vim')

  "" Python
  call dein#add('fs111/pydoc.vim')

  "" Lisp
  call dein#add('kovisoft/slimv')

  "" Clojure
  call dein#add('guns/vim-clojure-static')
  call dein#add('tpope/vim-fireplace')
  call dein#add('jbnicolai/rainbow_parentheses.vim')
  call dein#add('guns/vim-clojure-highlight')

  "" Ruby
  call dein#add('vim-ruby/vim-ruby')

  "" Go
  call dein#add('fatih/vim-go')

  "" Git
  "" Show what has changed in the sidebar + ability to stage, revert hunks
  call dein#add('airblade/vim-gitgutter')
  call dein#add('tpope/vim-fugitive')

  "" HTML
  call dein#add('gregsexton/MatchTag')

  "" css
  call dein#add('cakebaker/scss-syntax.vim')

  call dein#add('AndrewRadev/splitjoin.vim')
  call dein#add('scrooloose/syntastic')
  call dein#add('tpope/vim-surround')
  call dein#add('jiangmiao/auto-pairs')

  call dein#add('Lokaltog/vim-easymotion')

  "" Navigation
  call dein#add('jeetsukumaran/vim-buffergator')
  call dein#add('scrooloose/nerdtree')
  call dein#add('ervandew/supertab')
  call dein#add('ctrlpvim/ctrlp.vim')
  call dein#add('scrooloose/nerdcommenter')

  "" Search
  call dein#add('https://github.com/mileszs/ack.vim.git')

  "" GPG
  call dein#add('https://gitorious.org/vim-gnupg/vim-gnupg.git')

  " cursor with iterm2
  call dein#add('sjl/vitality.vim')

  " Required:
  call dein#end()
  call dein#save_state()
endif

filetype plugin indent on

" set 256 colors
set t_Co=256
colorscheme wombat256
syntax on

set noantialias
" on macvim there's no visual bell and avoid
" to beep every few keystrokes
set vb
if has("gui_running")
    set guifont=fixed-6x13:h13
    set linespace=0

    " remove menu and toolbar
    set guioptions-=m
    set guioptions-=T
    set guioptions-=r
    set guioptions-=l
    set guioptions-=L
    set guioptions-=r
    set guioptions-=R
endif

if &term =~ '256color'
  " disable Background Color Erase (BCE) so that color schemes
  " render properly when inside 256-color tmux and GNU screen.
  " see also http://snk.tuxfamily.org/log/vim-256color-bce.html
  set t_ut=
endif

nnoremap <SPACE> <Nop>
let mapleader=" "

inoremap jj <ESC>
inoremap jk <ESC>
nnoremap ; :

map <F10> :echo "hi<" . synIDattr(synID(line("."),col("."),1),"name") . '> trans<'
\ . synIDattr(synID(line("."),col("."),0),"name") . "> lo<"
\ . synIDattr(synIDtrans(synID(line("."),col("."),1)),"name") . ">"<CR>

" Vertical split
noremap <leader>vs :vsplit<CR>
noremap <leader>hs :split<CR>
" Open NerdTree
noremap <leader>n :NERDTreeToggle<CR>
" Clear highlight
noremap <leader>/ :nohlsearch<CR>
" create taglist
noremap <leader>gt :!ctags --extra=+f --exclude=.git --exclude=log -R * `rvm gemdir`/gems/*<CR><CR>
" edit vimrc
nnoremap <leader>ev <C-w><C-v><C-l>:e $MYVIMRC<cr>
" source vimrc
nnoremap <leader>sv :so $MYVIMRC<CR>
noremap <leader>aa :Ack "<C-R><C-W>"<CR>

nnoremap <leader>dq viw<esc>a"<esc>hbi"<esc>lel
nnoremap <leader>q viw<esc>a'<esc>hbi'<esc>lel
nnoremap <leader>q= viw<esc>a %><esc>hbi<%= <esc>lel
nnoremap <leader>q% viw<esc>a %}<esc>hbi{% <esc>lel

set relativenumber
set number
" Moving Around/Editing
set cursorline              " have a line indicate the cursor location
set nostartofline           " Avoid moving cursor to BOL when jumping around
set scrolloff=3             " Keep 3 context lines above and below the cursor
set backspace=2             " Allow backspacing over autoindent, EOL, and BOL
set showmatch               " Briefly jump to a parent once it's balanced
set nowrap                  " don't wrap lines
set autoindent              " always set autoindenting on
set smartindent             " use smart indent if there is no indent file
set tabstop=4               " <tab> inserts 4 spaces
set shiftwidth=4            " but an indent level is 2 spaces wide.
set softtabstop=4           " <BS> over an autoindent deletes both spaces.
set expandtab               " Use spaces, not tabs, for autoindent/tab key.
set shiftround              " rounds indent to a multiple of shiftwidth
set matchpairs+=<:>         " show matching <> (html mainly) as well
set nofoldenable
set foldlevel=99            " don't fold by default
"some stuff to get the mouse going in term
set mouse=a

""Messages, Info, Status
set ls=2                    " always show status line
set confirm                 " Y-N-C prompt if closing with unsaved changes.
set showcmd                 " Show incomplete normal mode commands as I type.
set report=0                " : commands always print changed line count.
set shortmess+=a            " Use [+]/[RO]/[w] for modified/readonly/written.
set ruler                   " Show some info, even without statuslines.
set laststatus=2            " Always show statusline, even if only 1 window.

""status
set statusline=(%n)
set statusline+=[%f]       "tail of the filename
set statusline+=[%{strlen(&fenc)?&fenc:'none'}, "file encoding
set statusline+=%{&ff}] "file format
set statusline+=%h      "help file flag
set statusline+=%m      "modified flag
set statusline+=%r      "read only flag
set statusline+=%y      "filetype
set statusline+=%=      "left/right separator
set statusline+=%c,     "cursor column
set statusline+=%l/%L   "cursor line/total lines
set statusline+=\ %P    "percent through file

" displays tabs with :set list & displays when a line runs off-screen
set listchars=tab:❘-,trail:·,extends:»,precedes:«,nbsp:×
set fillchars=diff:⣿,vert:│
set list
let &colorcolumn=join(range(90,999),",")
let &colorcolumn="80,".join(range(120,999),",")

let loaded_matchparen = 1
let g:syntastic_python_checkers=['flake8', 'pep8']
let g:syntastic_ruby_checkers = ['rubocop', 'reek', 'mri']
" Searching and Patterns
set ignorecase              " Default to using case insensitive searches,
set smartcase               " unless uppercase letters are used in the regex.
set smarttab                " Handle tabs more intelligently
set hlsearch                " Highlight searches by default.
set incsearch               " Incrementally search while typing a /regex

let g:ackprg = 'ag --nogroup --nocolor --column'

" nerdtree
let NERDTreeShowHidden=1
let NERDTreeIgnore = ['\.pyc$', '\.sw[o,p]$', '__pycache__', '.git']

" python
au FileType python set omnifunc=pythoncomplete#Complete
au FileType python setlocal expandtab shiftwidth=4 tabstop=8 softtabstop=4 smartindent cinwords=if,elif,else,for,while,try,except,finally,def,class,with
au BufRead *.py set efm=%C\ %.%#,%A\ \ File\ \"%f\"\\,\ line\ %l%.%#,%Z%[%^\

" Ruby
au Filetype ruby setlocal tabstop=2 softtabstop=2 shiftwidth=2 smartindent cinwords=if,elsif,else,unless,for,while,begin,rescue,def,class,module

" JavaScript
au FileType javascript setlocal expandtab shiftwidth=2 tabstop=2 softtabstop=2
au FileType javascript set omnifunc=javascriptcomplete#CompleteJS

" html/css
au FileType jade set omnifunc=javascriptcomplete#CompleteJS
au FileType jade setlocal expandtab shiftwidth=2 softtabstop=2
au FileType html set omnifunc=htmlcomplete#CompleteTags
au FileType html setlocal expandtab shiftwidth=2 softtabstop=2
au FileType css set omnifunc=csscomplete#CompleteCSS
au FileType css setlocal expandtab shiftwidth=2 softtabstop=2 tabstop=2
au FileType html noremap <buffer> <c-f> :call HtmlBeautify()<cr>
au FileType css noremap <buffer> <c-f> :call CSSBeautify()<cr>
au Filetype scss setlocal tabstop=2 softtabstop=2 shiftwidth=2 smartindent
au BufRead *.ejs set filetype=html
au BufRead *.erb set filetype=html

au FileType go set expandtab!
au FileType go set listchars=tab:\ \ 
au FileType go hi SpecialKey guibg=NONE

" github
au BufNewFile,BufRead COMMIT_EDITMSG setlocal spell

" LISP
au FileType lisp setlocal expandtab shiftwidth=2 tabstop=2 softtabstop=2

" clojure
autocmd VimEnter *       RainbowParenthesesToggle
autocmd Syntax   clojure RainbowParenthesesLoadRound
autocmd Syntax   clojure RainbowParenthesesLoadSquare
autocmd Syntax   clojure RainbowParenthesesLoadBraces

" go
au FileType go nmap <leader>r <Plug>(go-run)
autocmd VimEnter *       RainbowParenthesesToggle
